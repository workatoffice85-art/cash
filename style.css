function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var data = JSON.parse(e.postData.contents);
  sheet.appendRow([data.date, data.location, data.hours, data.expenses, data.notes, ""]);
  return ContentService.createTextOutput(JSON.stringify({status: "success"}))
    .setMimeType(ContentService.MimeType.JSON);
}

function doGet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var rows = sheet.getRange("A6:E1000").getValues();
  var data = [];
  for (var i = 0; i < rows.length; i++) {
    if (rows[i][0] !== "") {
      data.push({
        date: rows[i][0],
        location: rows[i][1],
        hours: rows[i][2],
        expenses: rows[i][3],
        notes: rows[i][4]
      });
    }
  }
  return ContentService.createTextOutput(JSON.stringify(data.reverse()))
    .setMimeType(ContentService.MimeType.JSON);
}
